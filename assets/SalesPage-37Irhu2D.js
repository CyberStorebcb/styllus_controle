import{Q,b as q,c as f,a as y}from"./QList-BtZDoZvV.js";import{r as V,o as k,Y as u,Z as c,_ as s,a0 as d,$ as n,a9 as x,aa as N,a3 as v,a4 as D,a5 as B,a2 as b,a7 as _,a1 as S,a6 as E,ai as t,ah as p}from"./index-Gk3z1Mj9.js";import{Q as $}from"./QPage-DEpJDiRT.js";import{a as h}from"./index-xsH4HHeE.js";import{_ as I}from"./_plugin-vue_export-helper-DlAUqK2U.js";const M={class:"sales-container"},w={key:1,class:"text-center q-mt-md"},L={__name:"SalesPage",setup(O){const i=V([]);async function g(){try{const o=await h.get("http://localhost:3001/api/products");i.value=o.data}catch{t.create({type:"negative",message:"Erro ao buscar produtos do servidor."})}}k(g);function P(o){const e=i.value.find(a=>a.id===o);if(!e){t.create({type:"negative",message:"Produto não encontrado."});return}p.create({title:"Vender Produto",message:`Informe a quantidade para vender o produto "${e.name}":`,prompt:{model:"",type:"number",isValid:a=>a>0&&a<=e.quantity,label:"Quantidade",placeholder:`Máximo: ${e.quantity}`},cancel:!0,persistent:!0}).onOk(a=>{const r=parseInt(a,10);if(!o||isNaN(r)||r<=0||r>e.quantity){t.create({type:"negative",message:"Preencha todos os campos corretamente."});return}p.create({title:"Preço Unitário",message:`Informe o preço unitário do produto "${e.name}":`,prompt:{model:"",type:"number",isValid:m=>m>0,label:"Preço Unitário",placeholder:"Digite o preço unitário"},cancel:!0,persistent:!0}).onOk(m=>{const l=parseFloat(m);if(!o||isNaN(l)||l<=0){t.create({type:"negative",message:"Preencha todos os campos corretamente."});return}p.create({title:"Método de Pagamento",message:"Selecione o método de pagamento:",options:{type:"radio",model:"",items:[{label:"Dinheiro",value:"Dinheiro"},{label:"Cartão de Crédito",value:"Cartão de Crédito"},{label:"Cartão de Débito",value:"Cartão de Débito"},{label:"Pix",value:"Pix"},{label:"Boleto",value:"Boleto"}]},cancel:!0,persistent:!0}).onOk(C=>{if(!o||!l||!r||r<=0||l<=0){t.create({type:"negative",message:"Preencha todos os campos corretamente."});return}h.post("http://localhost:3001/api/sales",{productId:o,quantity:r,price:l,paymentMethod:C}).then(()=>{t.create({type:"positive",message:"Venda registrada com sucesso!"}),g()}).catch(()=>{t.create({type:"negative",message:"Erro ao registrar a venda."})})}).onCancel(()=>{t.create({type:"info",message:"Venda cancelada."})})}).onCancel(()=>{t.create({type:"info",message:"Venda cancelada."})})}).onCancel(()=>{t.create({type:"info",message:"Venda cancelada."})})}return(o,e)=>(c(),u($,null,{default:s(()=>[d("div",M,[e[2]||(e[2]=d("div",{class:"sales-title q-mb-lg"},"Nova Venda",-1)),n(x,{flat:"",bordered:"",class:"sales-card shadow-2"},{default:s(()=>[n(N,null,{default:s(()=>[e[1]||(e[1]=d("div",{class:"sales-section-title q-mb-md"},"Produtos Disponíveis",-1)),Array.isArray(i.value)&&i.value.length>0?(c(),u(Q,{key:0,class:"q-pa-none"},{default:s(()=>[(c(!0),v(D,null,B(i.value,a=>(c(),u(q,{key:a.id,class:"sales-item",disable:a.quantity===0},{default:s(()=>[n(f,null,{default:s(()=>[n(y,{class:"custom-font-bold sales-product-name"},{default:s(()=>[b(_(a.name),1)]),_:2},1024),n(y,{caption:"",class:"custom-font-light sales-qty"},{default:s(()=>[b(" Quantidade: "+_(a.quantity),1)]),_:2},1024)]),_:2},1024),n(f,{side:""},{default:s(()=>[n(S,{icon:"shopping_cart",label:"VENDER",color:"primary",unelevated:"",class:"sales-btn",onClick:r=>P(a.id),disable:a.quantity===0,"no-caps":""},null,8,["onClick","disable"])]),_:2},1024)]),_:2},1032,["disable"]))),128))]),_:1})):(c(),v("div",w,[n(E,{name:"info",size:"lg",color:"grey-6"}),e[0]||(e[0]=d("p",{class:"custom-font-light text-grey"},"Nenhum produto disponível para venda.",-1))]))]),_:1})]),_:1})])]),_:1}))}},T=I(L,[["__scopeId","data-v-8b38273d"]]);export{T as default};
